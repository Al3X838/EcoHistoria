{% extends "base.html" %}

{% block title %}Mis Recompensas - UCA Verde{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1 class="page-title">
            <span class="icon">ğŸ</span> Mis Recompensas Canjeadas
        </h1>
        <p class="page-subtitle">Historial de todos tus canjes</p>
    </div>

    <div class="card">
        {% if canjes %}
            <div class="my-rewards-list">
                {% for canje in canjes %}
                <div class="my-reward-item">
                    <div class="reward-icon-large">
                        {% if 'cafeterÃ­a' in canje.recompensa.nombre.lower() or 'cafeteria' in canje.recompensa.nombre.lower() %}â˜•
                        {% elif 'botella' in canje.recompensa.nombre.lower() %}ğŸ¼
                        {% elif 'camiseta' in canje.recompensa.nombre.lower() %}ğŸ‘•
                        {% elif 'certificado' in canje.recompensa.nombre.lower() %}ğŸ“œ
                        {% elif 'estudio' in canje.recompensa.nombre.lower() %}ğŸ“š
                        {% elif 'estacionamiento' in canje.recompensa.nombre.lower() %}ğŸš—
                        {% else %}ğŸ
                        {% endif %}
                    </div>

                    <div class="reward-details">
                        <h3 class="reward-name">{{ canje.recompensa.nombre }}</h3>
                        <p class="reward-description">{{ canje.recompensa.descripcion }}</p>
                        
                        <div class="reward-meta">
                            <span class="meta-item">
                                <span class="meta-icon">ğŸ“…</span>
                                Canjeado: {{ canje.fecha_canje.strftime('%d/%m/%Y') }}
                            </span>
                            <span class="meta-item">
                                <span class="meta-icon">ğŸ’°</span>
                                Costo: {{ canje.recompensa.puntos_costo }} pts
                            </span>
                        </div>

                        {% if canje.codigo %}
                        <div class="coupon-code-container" style="margin-top: 1rem; padding: 10px; background: var(--bg-card); border: 1px dashed var(--primary-color); border-radius: 8px; display: inline-block;">
                            <small style="display: block; color: var(--text-muted); font-size: 0.8em; margin-bottom: 4px;">Tu cÃ³digo para canjear:</small>
                            <span style="font-family: 'Courier New', monospace; font-size: 1.4em; font-weight: 800; color: var(--primary-color); letter-spacing: 2px;">
                                {{ canje.codigo }}
                            </span>
                        </div>
                        {% endif %}
                    </div>

                    <div class="reward-status">
                        <span class="status-badge status-{{ canje.estado }}">
                            {% if canje.estado == 'pendiente' %}
                                â³ Pendiente
                            {% elif canje.estado == 'entregado' %}
                                âœ… Entregado
                            {% elif canje.estado == 'cancelado' %}
                                âŒ Cancelado
                            {% endif %}
                        </span>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="empty-state-large">
                <span class="empty-icon">ğŸ</span>
                <p>No has canjeado recompensas aÃºn.</p>
                <a href="{{ url_for('rewards.index') }}" class="btn btn-primary">Ver CatÃ¡logo</a>
            </div>
        {% endif %}
    </div>

    {% if canjes %}
    <div class="canje-info-box">
        <h3>ğŸ“ CÃ³mo recoger tus recompensas</h3>
        <ul>
            <li>DirÃ­gete al Punto Verde UCA (Edificio de AdministraciÃ³n, Planta Baja)</li>
            <li>Presenta tu carnet universitario y el <strong>cÃ³digo del cupÃ³n</strong>.</li>
            <li>Horario de atenciÃ³n: Lunes a Viernes, 8:00 AM - 4:00 PM</li>
            <li>Las recompensas estÃ¡n disponibles 48 horas despuÃ©s del canje</li>
        </ul>
    </div>
    {% endif %}
</div>
{% endblock %}